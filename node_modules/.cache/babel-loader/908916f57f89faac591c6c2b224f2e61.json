{"ast":null,"code":"import _regeneratorRuntime from \"/Users/tamashollos/Git/living-togeter/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/tamashollos/Git/living-togeter/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport { ref } from '@vue/reactivity';\nimport { useStore } from 'vuex';\nimport PostList from './PostList.vue';\nexport default {\n  components: {\n    PostList: PostList\n  },\n  setup: function setup() {\n    var store = useStore();\n    var isPosting = ref(false);\n    var post = ref('');\n    var posts = ref([]);\n    function addPost() {\n      isPosting.value = true;\n    }\n    function cancelPost() {\n      isPosting.value = false;\n    }\n    function uploadPost(_x) {\n      return _uploadPost.apply(this, arguments);\n    }\n    function _uploadPost() {\n      _uploadPost = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(e) {\n        var profile, curDate, postWannabe;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                profile = store.getters['profiles/getProfile'];\n                console.log(profile);\n                curDate = new Date().toLocaleString('eu-dk').split(',');\n                postWannabe = {\n                  userId: localStorage.getItem('userId'),\n                  email: localStorage.getItem('email'),\n                  post: post.value,\n                  date: curDate,\n                  firstName: profile.firstName,\n                  lastName: profile.lastName\n                };\n                _context.next = 7;\n                return store.dispatch('posts/generatePost', postWannabe);\n              case 7:\n                post.value = '';\n                e.target.value = '';\n                isPosting.value = false;\n                _context.next = 15;\n                break;\n              case 12:\n                _context.prev = 12;\n                _context.t0 = _context[\"catch\"](0);\n                console.log(_context.t0);\n              case 15:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 12]]);\n      }));\n      return _uploadPost.apply(this, arguments);\n    }\n    function init() {\n      return _init.apply(this, arguments);\n    }\n    function _init() {\n      _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var postsArr;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return store.dispatch('profiles/fetchProfile', localStorage.getItem('userId'));\n              case 3:\n                _context2.next = 5;\n                return store.dispatch('posts/loadPosts');\n              case 5:\n                postsArr = store.getters['posts/getPosts'];\n                posts.value = postsArr;\n                _context2.next = 12;\n                break;\n              case 9:\n                _context2.prev = 9;\n                _context2.t0 = _context2[\"catch\"](0);\n                console.log(_context2.t0);\n              case 12:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[0, 9]]);\n      }));\n      return _init.apply(this, arguments);\n    }\n    init();\n    return {\n      addPost: addPost,\n      isPosting: isPosting,\n      cancelPost: cancelPost,\n      post: post,\n      uploadPost: uploadPost,\n      posts: posts\n    };\n  }\n};","map":{"version":3,"mappings":";;;AAeA,SAASA,GAAE,QAAS,iBAAgB;AACpC,SAASC,QAAO,QAAS,MAAK;AAC9B,OAAOC,QAAO,MAAO,gBAAe;AAGpC,eAAe;EACbC,UAAU,EAAE;IAAED,QAAO,EAAPA;EAAS,CAAC;EAGtBE,KAAK,mBAAG;IACJ,IAAMC,KAAI,GAAIJ,QAAQ,EAAC;IACvB,IAAMK,SAAQ,GAAIN,GAAG,CAAC,KAAK;IAC3B,IAAMO,IAAG,GAAIP,GAAG,CAAC,EAAE;IACnB,IAAMQ,KAAI,GAAIR,GAAG,CAAC,EAAE;IAEpB,SAASS,OAAO,GAAG;MACfH,SAAS,CAACI,KAAI,GAAI,IAAG;IACzB;IACA,SAASC,UAAU,GAAG;MAClBL,SAAS,CAACI,KAAI,GAAI,KAAI;IAC1B;IAAA,SAEeE,UAAU;MAAA;IAAA;IAAA;MAAA,yEAAzB,iBAA0BC,CAAC;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAGbC,OAAM,GAAIT,KAAK,CAACU,OAAO,CAAC,qBAAqB;gBACnDC,OAAO,CAACC,GAAG,CAACH,OAAO,CAAC;gBACdI,OAAM,GAAI,IAAIC,IAAI,EAAE,CAACC,cAAc,CAAC,OAAO,CAAC,CAACC,KAAK,CAAC,GAAG;gBAEtDC,WAAU,GAAI;kBAChBC,MAAM,EAAEC,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC;kBACtCC,KAAK,EAAEF,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;kBACpClB,IAAI,EAAEA,IAAI,CAACG,KAAK;kBAChBiB,IAAI,EAAET,OAAO;kBACbU,SAAS,EAAEd,OAAO,CAACc,SAAS;kBAC5BC,QAAQ,EAAEf,OAAO,CAACe;gBACtB;gBAAA;gBAAA,OAEMxB,KAAK,CAACyB,QAAQ,CAAC,oBAAoB,EAAER,WAAW;cAAA;gBACtDf,IAAI,CAACG,KAAI,GAAI,EAAC;gBACdG,CAAC,CAACkB,MAAM,CAACrB,KAAI,GAAI,EAAC;gBAClBJ,SAAS,CAACI,KAAI,GAAI,KAAI;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAKtBM,OAAO,CAACC,GAAG,aAAK;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,CAExB;MAAA;IAAA;IAAA,SAEee,IAAI;MAAA;IAAA;IAAA;MAAA,mEAAnB;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA;gBAAA,OAEc3B,KAAK,CAACyB,QAAQ,CAAC,uBAAuB,EAAEN,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC;cAAA;gBAAA;gBAAA,OAEtEpB,KAAK,CAACyB,QAAQ,CAAC,iBAAiB;cAAA;gBAEhCG,QAAO,GAAI5B,KAAK,CAACU,OAAO,CAAC,gBAAgB;gBAE/CP,KAAK,CAACE,KAAI,GAAIuB,QAAO;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAIrBjB,OAAO,CAACC,GAAG,cAAK;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,CAExB;MAAA;IAAA;IAEAe,IAAI,EAAC;IAEL,OAAO;MAACvB,OAAO,EAAPA,OAAO;MAAEH,SAAS,EAATA,SAAS;MAAEK,UAAU,EAAVA,UAAU;MAAEJ,IAAI,EAAJA,IAAI;MAAEK,UAAU,EAAVA,UAAU;MAAEJ,KAAK,EAALA;IAAK;EACnE;AACJ","names":["ref","useStore","PostList","components","setup","store","isPosting","post","posts","addPost","value","cancelPost","uploadPost","e","profile","getters","console","log","curDate","Date","toLocaleString","split","postWannabe","userId","localStorage","getItem","email","date","firstName","lastName","dispatch","target","init","postsArr"],"sourceRoot":"","sources":["/Users/tamashollos/Git/living-togeter/src/components/community/Post.vue"],"sourcesContent":["<template>\n  <h2>Posts</h2>\n  <base-button v-if=\"!isPosting\" @click=\"addPost\" type=\"filled\">Share your thoughts...</base-button>\n  <div v-if=\"isPosting\">\n      <textarea  cols=\"50\" rows=\"5\" autofocus placeholder=\"...\" v-model.trim=\"post\"></textarea>\n        <div>\n            <base-button @click=\"cancelPost\" type=\"filled\">Cancel</base-button>\n            <base-button  @click=\"uploadPost\" type=\"filled\">Post</base-button>\n        </div>\n  </div>\n  <p v-if=\"!posts.length > 0\">There are no posts for this community yet...</p>\n  <post-list v-else :posts=\"posts\"></post-list>\n</template>\n\n<script>\nimport { ref } from '@vue/reactivity'\nimport { useStore } from 'vuex'\nimport PostList from './PostList.vue'\n\n\nexport default {\n  components: { PostList },\n\n\n    setup() {\n        const store = useStore()\n        const isPosting = ref(false)\n        const post = ref('')\n        const posts = ref([])\n\n        function addPost() {\n            isPosting.value = true\n        }\n        function cancelPost() {\n            isPosting.value = false\n        }\n\n        async function uploadPost(e) {\n            try{\n\n                const profile = store.getters['profiles/getProfile']\n                console.log(profile);\n                const curDate = new Date().toLocaleString('eu-dk').split(',')\n\n                const postWannabe = {\n                    userId: localStorage.getItem('userId'),\n                    email: localStorage.getItem('email'),\n                    post: post.value,\n                    date: curDate,\n                    firstName: profile.firstName,\n                    lastName: profile.lastName\n                }\n\n                await store.dispatch('posts/generatePost', postWannabe)\n                post.value = ''\n                e.target.value = ''\n                isPosting.value = false\n                \n\n\n            }catch(err) {\n                console.log(err);\n            }\n        }\n\n        async function init() {\n            try {\n                await store.dispatch('profiles/fetchProfile', localStorage.getItem('userId'))\n\n                await store.dispatch('posts/loadPosts')\n\n                const postsArr = store.getters['posts/getPosts']\n\n                posts.value = postsArr\n\n\n            }catch (err) {\n                console.log(err);\n            }\n        }\n\n        init()\n\n        return {addPost, isPosting, cancelPost, post, uploadPost, posts}\n    }\n}\n</script>\n\n<style>\n\n</style>"]},"metadata":{},"sourceType":"module"}