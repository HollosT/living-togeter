{"ast":null,"code":"import _regeneratorRuntime from \"/Users/tamashollos/Git/living-togeter/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/tamashollos/Git/living-togeter/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport { ref } from '@vue/reactivity';\nimport { useStore } from 'vuex';\nimport CommunityList from '@/components/community/CommunityList.vue';\nimport BaseCard from '@/components/UI/BaseCard.vue';\nexport default {\n  components: {\n    CommunityList: CommunityList,\n    BaseCard: BaseCard\n  },\n  setup: function setup() {\n    var store = useStore();\n    var building = ref({});\n    var members = ref([]);\n    function init() {\n      return _init.apply(this, arguments);\n    }\n    function _init() {\n      _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var buildingId, curBuilding, curApplications, key, userId, wannabeMember;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                buildingId = localStorage.getItem('buildingMember');\n                _context.prev = 1;\n                _context.next = 4;\n                return store.dispatch('buildings/loadBuilding', buildingId);\n              case 4:\n                _context.next = 6;\n                return store.getters['buildings/buildings'];\n              case 6:\n                curBuilding = _context.sent;\n                building.value = curBuilding;\n\n                // Fetch the residents of the building\n                _context.next = 10;\n                return store.dispatch('residents/fetchApplications', buildingId);\n              case 10:\n                _context.next = 12;\n                return store.getters['residents/getApplications'];\n              case 12:\n                curApplications = _context.sent;\n                _context.t0 = _regeneratorRuntime().keys(curApplications);\n              case 14:\n                if ((_context.t1 = _context.t0()).done) {\n                  _context.next = 25;\n                  break;\n                }\n                key = _context.t1.value;\n                userId = curApplications[key].userId;\n                _context.next = 19;\n                return store.dispatch('profiles/fetchProfile', userId);\n              case 19:\n                _context.next = 21;\n                return store.getters['profiles/getProfile'];\n              case 21:\n                wannabeMember = _context.sent;\n                members.value.push(wannabeMember);\n                _context.next = 14;\n                break;\n              case 25:\n                console.log(members.value);\n                _context.next = 31;\n                break;\n              case 28:\n                _context.prev = 28;\n                _context.t2 = _context[\"catch\"](1);\n                console.log(_context.t2);\n              case 31:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[1, 28]]);\n      }));\n      return _init.apply(this, arguments);\n    }\n    init();\n    return {\n      building: building,\n      members: members\n    };\n  }\n};","map":{"version":3,"mappings":";;;;;AAcA,SAASA,GAAE,QAAS,iBAAgB;AACpC,SAASC,QAAO,QAAS,MAAK;AAC9B,OAAOC,aAAY,MAAO,0CAAyC;AACnE,OAAOC,QAAO,MAAO,8BAA6B;AAElD,eAAe;EACbC,UAAU,EAAE;IAAEF,aAAa,EAAbA,aAAa;IAAEC,QAAO,EAAPA;EAAS,CAAC;EACrCE,KAAK,mBAAG;IACJ,IAAMC,KAAI,GAAIL,QAAQ,EAAC;IACvB,IAAMM,QAAO,GAAIP,GAAG,CAAC,CAAC,CAAC;IACvB,IAAMQ,OAAM,GAAIR,GAAG,CAAC,EAAE;IAAA,SAGPS,IAAI;MAAA;IAAA;IAAA;MAAA,mEAAnB;QAAA;QAAA;UAAA;YAAA;cAAA;gBACUC,UAAS,GAAIC,YAAY,CAACC,OAAO,CAAC,gBAAgB;gBAAA;gBAAA;gBAAA,OAG9CN,KAAK,CAACO,QAAQ,CAAC,wBAAwB,EAAEH,UAAU;cAAA;gBAAA;gBAAA,OAEhCJ,KAAK,CAACQ,OAAO,CAAC,qBAAqB;cAAA;gBAAvDC,WAAU;gBACfR,QAAQ,CAACS,KAAI,GAAID,WAAU;;gBAG3B;gBAAA;gBAAA,OACMT,KAAK,CAACO,QAAQ,CAAC,6BAA6B,EAAEH,UAAU;cAAA;gBAAA;gBAAA,OAEhCJ,KAAK,CAACQ,OAAO,CAAC,2BAA2B;cAAA;gBAAjEG,eAAc;gBAAA,yCAEJA,eAAe;cAAA;gBAAA;kBAAA;kBAAA;gBAAA;gBAAtBC,GAAE;gBACFC,MAAK,GAAIF,eAAe,CAACC,GAAG,CAAC,CAACC,MAAM;gBAAA;gBAAA,OAEpCb,KAAK,CAACO,QAAQ,CAAC,uBAAuB,EAAEM,MAAM;cAAA;gBAAA;gBAAA,OAExBb,KAAK,CAACQ,OAAO,CAAC,qBAAqB;cAAA;gBAAzDM,aAAY;gBAClBZ,OAAO,CAACQ,KAAK,CAACK,IAAI,CAACD,aAAa;gBAAA;gBAAA;cAAA;gBAIpCE,OAAO,CAACC,GAAG,CAACf,OAAO,CAACQ,KAAK,CAAC;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEzBM,OAAO,CAACC,GAAG,aAAK;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,CAGxB;MAAA;IAAA;IAEAd,IAAI,EAAC;IAGL,OAAO;MAACF,QAAQ,EAARA,QAAQ;MAAEC,OAAO,EAAPA;IAAO;EAC7B;AAGJ","names":["ref","useStore","CommunityList","BaseCard","components","setup","store","building","members","init","buildingId","localStorage","getItem","dispatch","getters","curBuilding","value","curApplications","key","userId","wannabeMember","push","console","log"],"sourceRoot":"","sources":["/Users/tamashollos/Git/living-togeter/src/pages/community/Community.vue"],"sourcesContent":["<template>\n<base-card>\n        <h2>{{building.name}}</h2>\n\n        <community-list :members=\"members\"></community-list>\n\n        \n\n\n</base-card>\n\n</template>\n\n<script>\nimport { ref } from '@vue/reactivity'\nimport { useStore } from 'vuex'\nimport CommunityList from '@/components/community/CommunityList.vue'\nimport BaseCard from '@/components/UI/BaseCard.vue'\n\nexport default {\n  components: { CommunityList, BaseCard },\n    setup() {\n        const store = useStore()\n        const building = ref({})\n        const members = ref([])\n\n\n        async function init() {\n            const buildingId = localStorage.getItem('buildingMember')\n            try {\n                // Fetch the current building\n                await store.dispatch('buildings/loadBuilding', buildingId)\n\n               const curBuilding = await store.getters['buildings/buildings']\n                building.value = curBuilding\n\n\n                // Fetch the residents of the building\n                await store.dispatch('residents/fetchApplications', buildingId)\n\n                const curApplications = await store.getters['residents/getApplications']\n\n               for(const key in curApplications) {\n                   const userId = curApplications[key].userId;\n\n                   await store.dispatch('profiles/fetchProfile', userId)\n\n                   const wannabeMember = await store.getters['profiles/getProfile']\n                   members.value.push(wannabeMember)\n\n                    \n               }\n               console.log(members.value);\n            } catch(err) {\n                console.log(err);\n            }\n\n        }\n        \n        init()\n        \n\n        return {building, members}\n    }\n\n\n}\n</script>\n\n<style>\n\n</style>"]},"metadata":{},"sourceType":"module"}