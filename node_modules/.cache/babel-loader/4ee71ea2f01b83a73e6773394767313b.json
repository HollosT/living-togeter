{"ast":null,"code":"import _regeneratorRuntime from \"/Users/tamashollos/Git/living-togeter/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _objectSpread from \"/Users/tamashollos/Git/living-togeter/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _asyncToGenerator from \"/Users/tamashollos/Git/living-togeter/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.error.to-string.js\";\nexport default {\n  login: function login(context, payload) {\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              return _context.abrupt(\"return\", context.dispatch('auth', _objectSpread(_objectSpread({}, payload), {}, {\n                mode: 'login'\n              })));\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }))();\n  },\n  signup: function signup(context, payload) {\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              return _context2.abrupt(\"return\", context.dispatch('auth', _objectSpread(_objectSpread({}, payload), {}, {\n                mode: 'signup'\n              })));\n            case 1:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }))();\n  },\n  auth: function auth(context, payload) {\n    return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n      var mode, url, response, responseData, error;\n      return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              mode = payload.mode;\n              url = \"https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyDFdJX12HXkQTuFCPN11sgU-vO-flAkYGY\";\n              if (mode === 'signup') {\n                url = \"https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyDFdJX12HXkQTuFCPN11sgU-vO-flAkYGY\";\n              }\n              _context3.next = 5;\n              return fetch(url, {\n                method: 'POST',\n                body: JSON.stringify({\n                  email: payload.email,\n                  password: payload.password,\n                  returnSecureToken: true\n                })\n              });\n            case 5:\n              response = _context3.sent;\n              _context3.next = 8;\n              return response.json();\n            case 8:\n              responseData = _context3.sent;\n              if (response.ok) {\n                _context3.next = 12;\n                break;\n              }\n              error = new Error(responseData.message || 'Failed to authenticate! Check your credentials!');\n              throw error;\n            case 12:\n              localStorage.setItem('token', responseData.idToken);\n              localStorage.setItem('userId', responseData.localId);\n              localStorage.setItem('email', responseData.email);\n              context.commit('setUser', {\n                token: responseData.idToken,\n                userId: responseData.localId,\n                email: responseData.email\n              });\n            case 16:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }))();\n  },\n  tryLogin: function tryLogin(context) {\n    var token = localStorage.getItem('token');\n    var userId = localStorage.getItem('userId');\n    if (token && userId) {\n      context.commit('setUser', {\n        token: token,\n        userId: userId\n      });\n    }\n  },\n  logout: function logout(context) {\n    localStorage.removeItem('token');\n    localStorage.removeItem('userId');\n    localStorage.removeItem('email');\n    localStorage.rem;\n    context.commit('setUser', {\n      userId: null,\n      token: null,\n      email: null\n    });\n  }\n};","map":{"version":3,"names":["login","context","payload","dispatch","mode","signup","auth","url","fetch","method","body","JSON","stringify","email","password","returnSecureToken","response","json","responseData","ok","error","Error","message","localStorage","setItem","idToken","localId","commit","token","userId","tryLogin","getItem","logout","removeItem","rem"],"sources":["/Users/tamashollos/Git/living-togeter/src/store/modules/auth/actions.js"],"sourcesContent":["\nexport default {\n\n    async login(context, payload) {\n        return context.dispatch('auth', {\n            ...payload,\n            mode: 'login'\n        })\n    },\n    async signup(context, payload) {\n        return context.dispatch('auth', {\n            ...payload,\n            mode: 'signup'\n        })\n\n    },\n\n    async auth(context, payload) {\n        const mode = payload.mode;\n        let url = `https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyDFdJX12HXkQTuFCPN11sgU-vO-flAkYGY`\n\n        if(mode === 'signup') {\n            url = `https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyDFdJX12HXkQTuFCPN11sgU-vO-flAkYGY`\n        }\n\n        const response = await fetch(url, {\n            method: 'POST',\n            body: JSON.stringify({\n                email: payload.email,\n                password: payload.password,\n                returnSecureToken: true\n            })\n        })\n\n        const responseData = await response.json()\n\n        if(!response.ok) {\n            const error = new Error(responseData.message || 'Failed to authenticate! Check your credentials!')\n            throw error\n        }\n\n        localStorage.setItem('token', responseData.idToken)\n        localStorage.setItem('userId', responseData.localId)\n        localStorage.setItem('email', responseData.email)\n\n      \n        context.commit('setUser', {\n            token: responseData.idToken,\n            userId: responseData.localId,\n            email: responseData.email\n        })\n    },\n\n    tryLogin(context) {\n        const token = localStorage.getItem('token')\n        const userId = localStorage.getItem('userId')\n\n        if(token && userId ) {\n            context.commit('setUser', {\n                token: token,\n                userId: userId,\n            })\n        }\n    },\n\n    logout(context) {\n        localStorage.removeItem('token');\n        localStorage.removeItem('userId');\n        localStorage.removeItem('email');\n        localStorage.rem\n\n\n        context.commit('setUser', {\n            userId: null,\n            token: null,\n            email: null,\n        })\n    }\n\n}"],"mappings":";;;;;;;AACA,eAAe;EAELA,KAAK,iBAACC,OAAO,EAAEC,OAAO,EAAE;IAAA;MAAA;QAAA;UAAA;YAAA;cAAA,iCACnBD,OAAO,CAACE,QAAQ,CAAC,MAAM,kCACvBD,OAAO;gBACVE,IAAI,EAAE;cAAO,GACf;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA;EACN,CAAC;EACKC,MAAM,kBAACJ,OAAO,EAAEC,OAAO,EAAE;IAAA;MAAA;QAAA;UAAA;YAAA;cAAA,kCACpBD,OAAO,CAACE,QAAQ,CAAC,MAAM,kCACvBD,OAAO;gBACVE,IAAI,EAAE;cAAQ,GAChB;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA;EAEN,CAAC;EAEKE,IAAI,gBAACL,OAAO,EAAEC,OAAO,EAAE;IAAA;MAAA;MAAA;QAAA;UAAA;YAAA;cACnBE,IAAI,GAAGF,OAAO,CAACE,IAAI;cACrBG,GAAG;cAEP,IAAGH,IAAI,KAAK,QAAQ,EAAE;gBAClBG,GAAG,0GAA0G;cACjH;cAAC;cAAA,OAEsBC,KAAK,CAACD,GAAG,EAAE;gBAC9BE,MAAM,EAAE,MAAM;gBACdC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;kBACjBC,KAAK,EAAEX,OAAO,CAACW,KAAK;kBACpBC,QAAQ,EAAEZ,OAAO,CAACY,QAAQ;kBAC1BC,iBAAiB,EAAE;gBACvB,CAAC;cACL,CAAC,CAAC;YAAA;cAPIC,QAAQ;cAAA;cAAA,OASaA,QAAQ,CAACC,IAAI,EAAE;YAAA;cAApCC,YAAY;cAAA,IAEdF,QAAQ,CAACG,EAAE;gBAAA;gBAAA;cAAA;cACLC,KAAK,GAAG,IAAIC,KAAK,CAACH,YAAY,CAACI,OAAO,IAAI,iDAAiD,CAAC;cAAA,MAC5FF,KAAK;YAAA;cAGfG,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEN,YAAY,CAACO,OAAO,CAAC;cACnDF,YAAY,CAACC,OAAO,CAAC,QAAQ,EAAEN,YAAY,CAACQ,OAAO,CAAC;cACpDH,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEN,YAAY,CAACL,KAAK,CAAC;cAGjDZ,OAAO,CAAC0B,MAAM,CAAC,SAAS,EAAE;gBACtBC,KAAK,EAAEV,YAAY,CAACO,OAAO;gBAC3BI,MAAM,EAAEX,YAAY,CAACQ,OAAO;gBAC5Bb,KAAK,EAAEK,YAAY,CAACL;cACxB,CAAC,CAAC;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA;EACN,CAAC;EAEDiB,QAAQ,oBAAC7B,OAAO,EAAE;IACd,IAAM2B,KAAK,GAAGL,YAAY,CAACQ,OAAO,CAAC,OAAO,CAAC;IAC3C,IAAMF,MAAM,GAAGN,YAAY,CAACQ,OAAO,CAAC,QAAQ,CAAC;IAE7C,IAAGH,KAAK,IAAIC,MAAM,EAAG;MACjB5B,OAAO,CAAC0B,MAAM,CAAC,SAAS,EAAE;QACtBC,KAAK,EAAEA,KAAK;QACZC,MAAM,EAAEA;MACZ,CAAC,CAAC;IACN;EACJ,CAAC;EAEDG,MAAM,kBAAC/B,OAAO,EAAE;IACZsB,YAAY,CAACU,UAAU,CAAC,OAAO,CAAC;IAChCV,YAAY,CAACU,UAAU,CAAC,QAAQ,CAAC;IACjCV,YAAY,CAACU,UAAU,CAAC,OAAO,CAAC;IAChCV,YAAY,CAACW,GAAG;IAGhBjC,OAAO,CAAC0B,MAAM,CAAC,SAAS,EAAE;MACtBE,MAAM,EAAE,IAAI;MACZD,KAAK,EAAE,IAAI;MACXf,KAAK,EAAE;IACX,CAAC,CAAC;EACN;AAEJ,CAAC"},"metadata":{},"sourceType":"module"}